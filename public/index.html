<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vector MCP - Index Manager</title>
    <link rel="stylesheet" href="index.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <div>
                <h1>Vector MCP - Index Manager</h1>
                <p>Manage your codebase indexes for enhanced Claude context</p>
            </div>
            <div class="theme-toggle" onclick="toggleTheme()" title="Toggle theme">
                <span class="theme-toggle-icon" id="theme-icon">ðŸŒ™</span>
            </div>
        </div>

        <div id="status-message"></div>

        <div class="section">
            <h2>Create New Index</h2>
            <div class="form-group">
                <label for="project-id">Project ID:</label>
                <input type="text" id="project-id" placeholder="e.g., my-webapp-v2" required>
            </div>
            <div class="form-group">
                <label for="directory-path">Directory Path:</label>
                <div class="form-row">
                    <input type="text" id="directory-path" placeholder="e.g., /Users/username/projects/my-app" required style="flex: 1;">
                </div>
                <small id="path-help" style="color: #666; font-size: 12px;">Tip: Use absolute paths for best results</small>
                <div id="path-validation" style="margin-top: 5px;"></div>
            </div>
            <div class="form-group">
                <label for="exclude-patterns">Additional Exclude Patterns (one per line):</label>
                <textarea id="exclude-patterns" placeholder="*.log&#10;temp/**&#10;*.tmp"></textarea>
            </div>
            <button onclick="createIndex()" id="create-btn">Create Index</button>
            <button onclick="testCurrentDir()" id="test-btn">Test with Current Directory</button>
        </div>

        <div class="section">
            <h2>Existing Projects</h2>
            <button onclick="loadProjects()" id="refresh-btn">Refresh</button>
            <div id="project-list" class="project-list">
                <!-- Projects will be loaded here -->
            </div>
        </div>

        <div class="section">
            <h2>Search Test</h2>
            <div class="form-group">
                <label for="search-query">Search Query:</label>
                <input type="text" id="search-query" placeholder="e.g., function to handle authentication">
            </div>
            <div class="form-group">
                <label for="search-project">Project (optional):</label>
                <select id="search-project">
                    <option value="">All projects</option>
                </select>
            </div>
            <div class="flex">
                <button onclick="testSearch()" id="search-btn">Search</button>
                <input type="number" id="search-limit" value="5" min="1" max="20" style="width: 80px;" placeholder="Limit">
            </div>
            <div id="search-results"></div>
        </div>

        <div class="section">
            <h2>Active Jobs</h2>
            <button onclick="loadJobs()" id="refresh-jobs-btn">Refresh</button>
            <div id="jobs-list">
                <!-- Active jobs will be loaded here -->
            </div>
        </div>

        <div class="section">
            <h2>Server Logs</h2>
            <div class="form-row">
                <button onclick="clearLogs()">Clear Server Logs</button>
                <span id="log-status" style="color: #666; font-size: 14px;">Connecting to log stream...</span>
            </div>
            <div id="logs" class="log-container"></div>
        </div>
    </div>

    <!-- Update Project Modal -->
    <div id="updateModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Update Project</h3>
                <span class="close" onclick="closeModal('updateModal')">&times;</span>
            </div>
            <div class="form-group">
                <label for="modal-project-id">Project ID:</label>
                <input type="text" id="modal-project-id" readonly>
            </div>
            <div class="form-group">
                <label for="modal-directory-path">Directory Path:</label>
                <input type="text" id="modal-directory-path" placeholder="/path/to/project" required>
            </div>
            <div class="form-group">
                <label for="modal-exclude-patterns">Additional Exclude Patterns (one per line):</label>
                <textarea id="modal-exclude-patterns" placeholder="*.log&#10;temp/**&#10;*.tmp"></textarea>
            </div>
            <div class="form-row">
                <button onclick="confirmUpdate()" id="modal-update-btn">Update Project</button>
                <button onclick="closeModal('updateModal')" style="background: #95a5a6;">Cancel</button>
            </div>
        </div>
    </div>

    <script src="index.js"></script>
</body>
</html>